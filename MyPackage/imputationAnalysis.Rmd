---
title: "imputationAnalysis"
author: "Sophia Ding"
date: "7/12/2019"
output: html_document
---

```{r,message=FALSE}
dataset <- read.delim("~/Desktop/dataset.s010")
library("imputeTS")
library("MyPackage")
library("zoo")
library("varhandle")
library("hydroGOF")
library("FSMUMI")
library("MLmetrics")
library("missForest")
```
zoo package; na_approx; 5 Missing Value (smooth)
```{r}
cleandata = clean(dataset)
data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)
trueValue_smooth <- x_smooth[c(131:135)]
x_smooth[c(131:135)] <- NA
y_smooth[c(131:135)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na.approx(x_smooth)
imputedValue1_smooth <- fit1_smooth[131:135]

tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:5) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/5
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_approx", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
zoo package; na_approx; 5 Missing Value (peak)
```{r}
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(157:161)]
x_peak[c(157:161)] <- NA
y_peak[c(157:161)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na.approx(x_peak)
imputedValue1_peak <- fit1_peak[157:161]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:5) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/5
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_approx", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
zoo package; na_approx; 5 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(235:239)]
x_bottom[c(235:239)] <- NA
y_bottom[c(235:239)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na.approx(x_bottom)
imputedValue1_bottom <- fit1_bottom[235:239]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:5) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/5
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_approx", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputation summary table for zoo packge: na_approx() with 5 missing values
```{r}
mad6_5missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse6_5missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape6_5missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa6_5missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb6_5missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3

st6_5missing = rbind(mad6_5missing, rmse6_5missing, mape6_5missing, ioa6_5missing, fb6_5missing)
st6_5missing
```

---------------------------------------------------------------------------------------------

zoo package; na_approx; 10 Missing Value (smooth)
```{r}
cleandata = clean(dataset)
data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(131:140)]
x_smooth[c(131:140)] <- NA
y_smooth[c(131:140)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na.approx(x_smooth)
imputedValue1_smooth <- fit1_smooth[131:140]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:10) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/10
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_approx", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
zoo package; na_approx; 10 Missing Value (peak)
```{r}
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(155:164)]
x_peak[c(155:164)] <- NA
y_peak[c(155:164)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na.approx(x_peak)
imputedValue1_peak <- fit1_peak[155:164]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:10) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/10
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_approx", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
zoo package; na_approx; 10 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(234:243)]
x_bottom[c(234:243)] <- NA
y_bottom[c(234:243)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na.approx(x_bottom)
imputedValue1_bottom <- fit1_bottom[234:243]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:10) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/10
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_approx", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputation summary table for zoo packge: na_approx() with 10 missing values
```{r}
mad6_10missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse6_10missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape6_10missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa6_10missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb6_10missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st6_10missing = rbind(mad6_10missing, rmse6_10missing, mape6_10missing, ioa6_10missing, fb6_10missing)
st6_10missing
```

------------------------------------------------------------------------------------------------------

zoo package; na_approx; 20 Missing Value (smooth)
```{r}
cleandata = clean(dataset)
data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(125:144)]
x_smooth[c(125:144)] <- NA
y_smooth[c(125:144)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na.approx(x_smooth)
imputedValue1_smooth <- fit1_smooth[125:144]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:20) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/20
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_approx", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
zoo package; na_approx; 20 Missing Value (peak)
```{r}
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(150:169)]
x_peak[c(150:169)] <- NA
y_peak[c(150:169)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na.approx(x_peak)
imputedValue1_peak <- fit1_peak[150:169]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:20) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/20
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_approx", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
zoo package; na_approx; 20 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(230:249)]
x_bottom[c(230:249)] <- NA
y_bottom[c(230:249)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na.approx(x_bottom)
imputedValue1_bottom <- fit1_bottom[230:249]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:20) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/20
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_approx", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputation summary table for zoo packge: na_approx() with 20 missing values
```{r}
mad6_20missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse6_20missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape6_20missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa6_20missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb6_20missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st6_20missing = rbind(mad6_20missing, rmse6_20missing, mape6_20missing, ioa6_20missing, fb6_20missing)
st6_20missing
```

---------------------------------------------------------------------------------------------

zoo package; na_approx; 30 Missing Value (smooth)
```{r}
cleandata = clean(dataset)
data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(120:149)]
x_smooth[c(120:149)] <- NA
y_smooth[c(120:149)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na.approx(x_smooth)
imputedValue1_smooth <- fit1_smooth[120:149]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:30) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/30
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_approx", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
zoo package; na_approx; 30 Missing Value (peak)
```{r}
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(145:174)]
x_peak[c(145:174)] <- NA
y_peak[c(145:174)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na.approx(x_peak)
imputedValue1_peak <- fit1_peak[145:174]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:30) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/30
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_approx", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
zoo package; na_approx; 30 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(225:254)]
x_bottom[c(225:254)] <- NA
y_bottom[c(225:254)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na.approx(x_bottom)
imputedValue1_bottom <- fit1_bottom[225:254]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:30) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/30
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_approx", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputation summary table for zoo packge: na_approx() with 30 missing values
```{r}
mad6_30missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse6_30missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape6_30missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa6_30missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb6_30missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st6_30missing = rbind(mad6_30missing, rmse6_30missing, mape6_30missing, ioa6_30missing, fb6_30missing)
st6_30missing
```
-------------------------------------------------------------------------------------------

zoo package; na_approx; 35 Missing Value (smooth)
```{r}
# cleandata = clean(dataset)
# data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(118:152)]
x_smooth[c(118:152)] <- NA
y_smooth[c(118:152)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na.approx(x_smooth)
imputedValue1_smooth <- fit1_smooth[118:152]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:35) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/35
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_approx", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
zoo package; na_approx; 35 Missing Value (peak)
```{r}
impuGV <- naInsert(data[[4]])
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(150:184)]
x_peak[c(150:184)] <- NA
y_peak[c(150:184)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na.approx(x_peak)
imputedValue1_peak <- fit1_peak[150:184]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:35) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/35
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_approx", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
zoo package; na_approx; 35 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(223:257)]
x_bottom[c(223:257)] <- NA
y_bottom[c(223:257)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na.approx(x_bottom)
imputedValue1_bottom <- fit1_bottom[223:257]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:35) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/35
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_approx", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```

imputation summary table for na_approxfor 35 missing values
```{r}
mad6_35missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse6_35missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape6_35missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa6_35missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb6_35missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st6_35missing = rbind(mad6_35missing, rmse6_35missing, mape6_35missing, ioa6_35missing, fb6_35missing)
st6_35missing
```
----------------------------------------------------------------------------------------
zoo package; na_approx; 40 Missing Value (smooth)
```{r}
# cleandata = clean(dataset)
# data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(115:154)]
x_smooth[c(115:154)] <- NA
y_smooth[c(115:154)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na.approx(x_smooth)
imputedValue1_smooth <- fit1_smooth[115:154]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:40) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/40
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_approx", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
zoo package; na_approx; 40 Missing Value (peak)
```{r}
impuGV <- naInsert(data[[4]])
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(148:187)]
x_peak[c(148:187)] <- NA
y_peak[c(148:187)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na.approx(x_peak)
imputedValue1_peak <- fit1_peak[148:187]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:40) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/40
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_approx", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
zoo package; na_approx; 40 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(220:259)]
x_bottom[c(220:259)] <- NA
y_bottom[c(220:259)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na.approx(x_bottom)
imputedValue1_bottom <- fit1_bottom[220:259]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:40) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/40
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_locf", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```

imputation summary table for na_approx for 40 missing values
```{r}
mad6_40missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse6_40missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape6_40missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa6_40missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb6_40missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st6_40missing = rbind(mad6_40missing, rmse6_40missing, mape6_40missing, ioa6_40missing, fb6_40missing)
st6_40missing
```
----------------------------------------------------------------------------------------
zoo package; na_approx; 50 Missing Value (smooth)
```{r}
# cleandata = clean(dataset)
# data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(110:159)]
x_smooth[c(110:159)] <- NA
y_smooth[c(110:159)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na.approx(x_smooth)
imputedValue1_smooth <- fit1_smooth[110:159]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:50) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/50
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_approx", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
zoo package; na_approx; 50 Missing Value (peak)
```{r}
impuGV <- naInsert(data[[4]])
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(143:192)]
x_peak[c(148:187)] <- NA
y_peak[c(148:187)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na.approx(x_peak)
imputedValue1_peak <- fit1_peak[148:187]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:50) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/50
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_approx", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
zoo package; na_approx; 50 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(215:264)]
x_bottom[c(215:264)] <- NA
y_bottom[c(215:264)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na.approx(x_bottom)
imputedValue1_bottom <- fit1_bottom[215:264]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:50) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/50
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_approx", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```

imputation summary table for na_approx for 50 missing values
```{r}
mad6_50missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse6_50missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape6_50missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa6_50missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb6_50missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st6_50missing = rbind(mad6_50missing, rmse6_50missing, mape6_50missing, ioa6_50missing, fb6_50missing)
st6_50missing
```

----------------------------------------------------------------------------------------------------------------

----------------------------------------------------------------------------------------------------


zoo package; na_spline; 5 Missing Value (smooth)
```{r}
cleandata = clean(dataset)
data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)
trueValue_smooth <- x_smooth[c(131:135)]
x_smooth[c(131:135)] <- NA
y_smooth[c(131:135)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na.spline(x_smooth)
imputedValue1_smooth <- fit1_smooth[131:135]

tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:5) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/5
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_spline", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
zoo package; na_spline; 5 Missing Value (peak)
```{r}
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(157:161)]
x_peak[c(157:161)] <- NA
y_peak[c(157:161)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na.spline(x_peak)
imputedValue1_peak <- fit1_peak[157:161]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:5) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/5
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_spline", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
zoo package; na_spline; 5 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(235:239)]
x_bottom[c(235:239)] <- NA
y_bottom[c(235:239)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na.spline(x_bottom)
imputedValue1_bottom <- fit1_bottom[235:239]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:5) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/5
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_spline", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputation summary table for zoo packge: na_spline() with 5 missing values
```{r}
mad7_5missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse7_5missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape7_5missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa7_5missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb7_5missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3

st7_5missing = rbind(mad7_5missing, rmse7_5missing, mape7_5missing, ioa7_5missing, fb7_5missing)
st7_5missing
```

----------------------------------------------------------------------------------------------

zoo package; na_spline; 10 Missing Value (smooth)
```{r}
cleandata = clean(dataset)
data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(131:140)]
x_smooth[c(131:140)] <- NA
y_smooth[c(131:140)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na.spline(x_smooth)
imputedValue1_smooth <- fit1_smooth[131:140]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:10) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/10
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_spline", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
zoo package; na_spline; 10 Missing Value (peak)
```{r}
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(155:164)]
x_peak[c(155:164)] <- NA
y_peak[c(155:164)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na.spline(x_peak)
imputedValue1_peak <- fit1_peak[155:164]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:10) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/10
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_spline", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
zoo package; na_spline; 10 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(234:243)]
x_bottom[c(234:243)] <- NA
y_bottom[c(234:243)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na.spline(x_bottom)
imputedValue1_bottom <- fit1_bottom[234:243]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:10) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/10
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_spline", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputation summary table for zoo packge: na_spline with 10 missing values
```{r}
mad7_10missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse7_10missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape7_10missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa7_10missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb7_10missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st7_10missing = rbind(mad7_10missing, rmse7_10missing, mape7_10missing, ioa7_10missing, fb7_10missing)
st7_10missing
```

----------------------------------------------------------------------------------------------

zoo package; na_spline; 20 Missing Value (smooth)
```{r}
cleandata = clean(dataset)
data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(125:144)]
x_smooth[c(125:144)] <- NA
y_smooth[c(125:144)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na.spline(x_smooth)
imputedValue1_smooth <- fit1_smooth[125:144]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:20) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/20
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_spline", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
zoo package; na_spline; 20 Missing Value (peak)
```{r}
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(150:169)]
x_peak[c(150:169)] <- NA
y_peak[c(150:169)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na.spline(x_peak)
imputedValue1_peak <- fit1_peak[150:169]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:20) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/20
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_spline", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
zoo package; na_spline; 20 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(230:249)]
x_bottom[c(230:249)] <- NA
y_bottom[c(230:249)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na.spline(x_bottom)
imputedValue1_bottom <- fit1_bottom[230:249]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:20) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/20
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_spline", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputation summary table for zoo packge: na_spline() with 20 missing values
```{r}
mad7_20missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse7_20missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape7_20missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa7_20missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb7_20missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st7_20missing = rbind(mad7_20missing, rmse7_20missing, mape7_20missing, ioa7_20missing, fb7_20missing)
st7_20missing
```

----------------------------------------------------------------------------------------------

zoo package; na_spline; 30 Missing Value (smooth)
```{r}
cleandata = clean(dataset)
data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(120:149)]
x_smooth[c(120:149)] <- NA
y_smooth[c(120:149)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na.spline(x_smooth)
imputedValue1_smooth <- fit1_smooth[120:149]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:30) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/30
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_spline", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
zoo package; na_spline; 30 Missing Value (peak)
```{r}
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(145:174)]
x_peak[c(145:174)] <- NA
y_peak[c(145:174)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na.spline(x_peak)
imputedValue1_peak <- fit1_peak[145:174]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:30) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/30
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_spline", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
zoo package; na_spline; 30 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(225:254)]
x_bottom[c(225:254)] <- NA
y_bottom[c(225:254)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na.spline(x_bottom)
imputedValue1_bottom <- fit1_bottom[225:254]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:30) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/30
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_spline", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputation summary table for zoo packge: na_spline() with 30 missing values
```{r}
mad7_30missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse7_30missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape7_30missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa7_30missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb7_30missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st7_30missing = rbind(mad7_30missing, rmse7_30missing, mape7_30missing, ioa7_30missing, fb7_30missing)
st7_30missing
```

-------------------------------------------------------------------------------------------

zoo package; na_spline; 35 Missing Value (smooth)
```{r}
# cleandata = clean(dataset)
# data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(118:152)]
x_smooth[c(118:152)] <- NA
y_smooth[c(118:152)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na.spline(x_smooth)
imputedValue1_smooth <- fit1_smooth[118:152]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:35) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/35
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_spline", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
zoo package; na_spline; 35 Missing Value (peak)
```{r}
impuGV <- naInsert(data[[4]])
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(150:184)]
x_peak[c(150:184)] <- NA
y_peak[c(150:184)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na.spline(x_peak)
imputedValue1_peak <- fit1_peak[150:184]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:35) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/35
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_spline", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
zoo package; na_spline; 35 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(223:257)]
x_bottom[c(223:257)] <- NA
y_bottom[c(223:257)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na.spline(x_bottom)
imputedValue1_bottom <- fit1_bottom[223:257]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:35) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/35
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_spline", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```

imputation summary table for na_spline for 35 missing values
```{r}
mad7_35missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse7_35missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape7_35missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa7_35missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb7_35missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st7_35missing = rbind(mad7_35missing, rmse7_35missing, mape7_35missing, ioa7_35missing, fb7_35missing)
st7_35missing
```
----------------------------------------------------------------------------------------
zoo package; na_spline; 40 Missing Value (smooth)
```{r}
# cleandata = clean(dataset)
# data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(115:154)]
x_smooth[c(115:154)] <- NA
y_smooth[c(115:154)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na.spline(x_smooth)
imputedValue1_smooth <- fit1_smooth[115:154]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:40) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/40
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_spline", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
zoo package; na_spline; 40 Missing Value (peak)
```{r}
impuGV <- naInsert(data[[4]])
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(148:187)]
x_peak[c(148:187)] <- NA
y_peak[c(148:187)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na.spline(x_peak)
imputedValue1_peak <- fit1_peak[148:187]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:40) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/40
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_spline", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
zoo package; na_spline; 40 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(220:259)]
x_bottom[c(220:259)] <- NA
y_bottom[c(220:259)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na.spline(x_bottom)
imputedValue1_bottom <- fit1_bottom[220:259]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:40) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/40
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_spline", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```

imputation summary table for na_spline for 40 missing values
```{r}
mad7_40missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse7_40missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape7_40missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa7_40missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb7_40missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st7_40missing = rbind(mad7_40missing, rmse7_40missing, mape7_40missing, ioa7_40missing, fb7_40missing)
st7_40missing
```
----------------------------------------------------------------------------------------
zoo package; na_spline; 50 Missing Value (smooth)
```{r}
# cleandata = clean(dataset)
# data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(110:159)]
x_smooth[c(110:159)] <- NA
y_smooth[c(110:159)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na.spline(x_smooth)
imputedValue1_smooth <- fit1_smooth[110:159]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:50) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/50
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_spline", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
zoo package; na_spline; 50 Missing Value (peak)
```{r}
impuGV <- naInsert(data[[4]])
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(143:192)]
x_peak[c(148:187)] <- NA
y_peak[c(148:187)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na.spline(x_peak)
imputedValue1_peak <- fit1_peak[148:187]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:50) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/50
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_spline", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
zoo package; na_spline; 50 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(215:264)]
x_bottom[c(215:264)] <- NA
y_bottom[c(215:264)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na.spline(x_bottom)
imputedValue1_bottom <- fit1_bottom[215:264]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:50) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/50
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_spline", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```

imputation summary table for na_spline for 50 missing values
```{r}
mad7_50missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse7_50missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape7_50missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa7_50missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb7_50missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st7_50missing = rbind(mad7_50missing, rmse7_50missing, mape7_50missing, ioa7_50missing, fb7_50missing)
st7_50missing
```

----------------------------------------------------------------------------------------------------------------

----------------------------------------------------------------------------------------------------


imputeTS package; linear; 5 Missing Value (smooth)
```{r}
cleandata = clean(dataset)
data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)
trueValue_smooth <- x_smooth[c(131:135)]
x_smooth[c(131:135)] <- NA
y_smooth[c(131:135)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na_interpolation(x_smooth, option = "linear", maxgap = Inf)
imputedValue1_smooth <- fit1_smooth[131:135]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:5) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/5
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_interpolation linear", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; linear; 5 Missing Value (peak)
```{r}
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(157:161)]
x_peak[c(157:161)] <- NA
y_peak[c(157:161)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na_interpolation(x_peak, option = "linear", maxgap = Inf)
imputedValue1_peak <- fit1_peak[157:161]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:5) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/5
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_interpolation linear", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; linear; 5 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(235:239)]
x_bottom[c(235:239)] <- NA
y_bottom[c(235:239)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na_interpolation(x_bottom, option = "linear", maxgap = Inf)
imputedValue1_bottom <- fit1_bottom[235:239]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:5) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/5
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_interpolation linear", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputation summary table for na_interpolation(linear) with 5 missing values
```{r}
mad1_5missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse1_5missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape1_5missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa1_5missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb1_5missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3

st1_5missing = rbind(mad1_5missing, rmse1_5missing, mape1_5missing, ioa1_5missing, fb1_5missing)
st1_5missing
```
----------------------------------------------------------------------------------------------

imputeTS package; linear; 10 Missing Value (smooth)

```{r}
cleandata = clean(dataset)
data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(131:140)]
x_smooth[c(131:140)] <- NA
y_smooth[c(131:140)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na_interpolation(x_smooth, option = "linear", maxgap = Inf)
imputedValue1_smooth <- fit1_smooth[131:140]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:10) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/10
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_interpolation linear", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; linear; 10 Missing Value (peak)
```{r}
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(155:164)]
x_peak[c(155:164)] <- NA
y_peak[c(155:164)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na_interpolation(x_peak, option = "linear", maxgap = Inf)
imputedValue1_peak <- fit1_peak[155:164]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:10) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/10
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_interpolation linear", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; linear; 10 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(234:243)]
x_bottom[c(234:243)] <- NA
y_bottom[c(234:243)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na_interpolation(x_bottom, option = "linear", maxgap = Inf)
imputedValue1_bottom <- fit1_bottom[234:243]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:10) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/10
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_interpolation linear", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputation summary table for na_interpolation(linear) with 10 missing values
```{r}
mad1_10missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse1_10missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape1_10missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa1_10missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb1_10missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st1_10missing = rbind(mad1_10missing, rmse1_10missing, mape1_10missing, ioa1_10missing, fb1_10missing)
st1_10missing
```
------------------------------------------------------------------------------------------------------

imputeTS package; linear; 20 Missing Value (smooth)
```{r}
cleandata = clean(dataset)
data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(125:144)]
x_smooth[c(125:144)] <- NA
y_smooth[c(125:144)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na_interpolation(x_smooth, option = "linear", maxgap = Inf)
imputedValue1_smooth <- fit1_smooth[125:144]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:20) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/20
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_interpolation linear", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; linear; 20 Missing Value (peak)
```{r}
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(150:169)]
x_peak[c(150:169)] <- NA
y_peak[c(150:169)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na_interpolation(x_peak, option = "linear", maxgap = Inf)
imputedValue1_peak <- fit1_peak[150:169]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:20) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/20
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_interpolation linear", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; linear; 20 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(230:249)]
x_bottom[c(230:249)] <- NA
y_bottom[c(230:249)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na_interpolation(x_bottom, option = "linear", maxgap = Inf)
imputedValue1_bottom <- fit1_bottom[230:249]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:20) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/20
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_interpolation linear", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputation summary table for na_interpolation(linear) with 20 missing values
```{r}
mad1_20missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse1_20missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape1_20missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa1_20missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb1_20missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st1_20missing = rbind(mad1_20missing, rmse1_20missing, mape1_20missing, ioa1_20missing, fb1_20missing)
st1_20missing
```

----------------------------------------------------------------------------------------------

imputeTS package; linear; 30 Missing Value (smooth)
```{r}
cleandata = clean(dataset)
data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(120:149)]
x_smooth[c(120:149)] <- NA
y_smooth[c(120:149)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na_interpolation(x_smooth, option = "linear", maxgap = Inf)
imputedValue1_smooth <- fit1_smooth[120:149]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:30) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/30
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_interpolation linear", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; linear; 30 Missing Value (peak)
```{r}
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(145:174)]
x_peak[c(145:174)] <- NA
y_peak[c(145:174)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na_interpolation(x_peak, option = "linear", maxgap = Inf)
imputedValue1_peak <- fit1_peak[145:174]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:30) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/30
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_interpolation linear", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; linear; 30 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(225:254)]
x_bottom[c(225:254)] <- NA
y_bottom[c(225:254)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na_interpolation(x_bottom, option = "linear", maxgap = Inf)
imputedValue1_bottom <- fit1_bottom[225:254]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:30) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/30
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_interpolation linear", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputation summary table for na_interpolation(linear) with 30 missing values
```{r}
mad1_30missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse1_30missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape1_30missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa1_30missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb1_30missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st1_30missing = rbind(mad1_30missing, rmse1_30missing, mape1_30missing, ioa1_30missing, fb1_30missing)
st1_30missing
```
-------------------------------------------------------------------------------------------

imputeTS package; na_locf; 35 Missing Value (smooth)
```{r}
# cleandata = clean(dataset)
# data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(118:152)]
x_smooth[c(118:152)] <- NA
y_smooth[c(118:152)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na_interpolation(x_smooth, option = "linear", maxgap = Inf)
imputedValue1_smooth <- fit1_smooth[118:152]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:35) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/35
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_locf", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; na_locf; 35 Missing Value (peak)
```{r}
impuGV <- naInsert(data[[4]])
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(150:184)]
x_peak[c(150:184)] <- NA
y_peak[c(150:184)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na_interpolation(x_peak, option = "linear", maxgap = Inf)
imputedValue1_peak <- fit1_peak[150:184]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:35) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/35
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_locf", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; na_locf; 35 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(223:257)]
x_bottom[c(223:257)] <- NA
y_bottom[c(223:257)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na_interpolation(x_bottom, option = "linear", maxgap = Inf)
imputedValue1_bottom <- fit1_bottom[223:257]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:35) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/35
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_locf", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```

imputation summary table for na_locf for 35 missing values
```{r}
mad1_35missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse1_35missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape1_35missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa1_35missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb1_35missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st1_35missing = rbind(mad1_35missing, rmse1_35missing, mape1_35missing, ioa1_35missing, fb1_35missing)
st1_35missing
```
----------------------------------------------------------------------------------------
imputeTS package; na_locf; 40 Missing Value (smooth)
```{r}
# cleandata = clean(dataset)
# data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(115:154)]
x_smooth[c(115:154)] <- NA
y_smooth[c(115:154)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na_interpolation(x_smooth, option = "linear", maxgap = Inf)
imputedValue1_smooth <- fit1_smooth[115:154]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:40) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/40
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_locf", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; na_locf; 40 Missing Value (peak)
```{r}
impuGV <- naInsert(data[[4]])
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(148:187)]
x_peak[c(148:187)] <- NA
y_peak[c(148:187)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na_interpolation(x_peak, option = "linear", maxgap = Inf)
imputedValue1_peak <- fit1_peak[148:187]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:40) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/40
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_locf", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; na_locf; 40 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(220:259)]
x_bottom[c(220:259)] <- NA
y_bottom[c(220:259)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na_interpolation(x_bottom, option = "linear", maxgap = Inf)
imputedValue1_bottom <- fit1_bottom[220:259]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:40) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/40
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_locf", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```

imputation summary table for na_locf for 40 missing values
```{r}
mad1_40missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse1_40missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape1_40missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa1_40missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb1_40missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st1_40missing = rbind(mad1_40missing, rmse1_40missing, mape1_40missing, ioa1_40missing, fb1_40missing)
st1_40missing
```
----------------------------------------------------------------------------------------
imputeTS package; na_locf; 50 Missing Value (smooth)
```{r}
# cleandata = clean(dataset)
# data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(110:159)]
x_smooth[c(110:159)] <- NA
y_smooth[c(110:159)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na_interpolation(x_smooth, option = "linear", maxgap = Inf)
imputedValue1_smooth <- fit1_smooth[110:159]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:50) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/50
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_locf", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; na_locf; 50 Missing Value (peak)
```{r}
impuGV <- naInsert(data[[4]])
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(143:192)]
x_peak[c(148:187)] <- NA
y_peak[c(148:187)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na_interpolation(x_peak, option = "linear", maxgap = Inf)
imputedValue1_peak <- fit1_peak[148:187]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:50) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/50
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_locf", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; na_locf; 50 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(215:264)]
x_bottom[c(215:264)] <- NA
y_bottom[c(215:264)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na_interpolation(x_bottom, option = "linear", maxgap = Inf)
imputedValue1_bottom <- fit1_bottom[215:264]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:50) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/50
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_locf", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```

imputation summary table for na_locf for 50 missing values
```{r}
mad1_50missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse1_50missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape1_50missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa1_50missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb1_50missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st1_50missing = rbind(mad1_50missing, rmse1_50missing, mape1_50missing, ioa1_50missing, fb1_50missing)
st1_50missing
```

----------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------

imputeTS package; spline; 5 Missing Value (smooth)
```{r}
cleandata = clean(dataset)
data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(131:135)]
x_smooth[c(131:135)] <- NA
y_smooth[c(131:135)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na_interpolation(x_smooth, option = "spline", maxgap = Inf)
imputedValue1_smooth <- fit1_smooth[131:135]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:5) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/5
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_interpolation spline", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; spline; 5 Missing Value (peak)
```{r}
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(157:161)]
x_peak[c(157:161)] <- NA
y_peak[c(157:161)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na_interpolation(x_peak, option = "spline", maxgap = Inf)
imputedValue1_peak <- fit1_peak[157:161]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:5) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/5
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_interpolation spline", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; spline; 5 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(235:239)]
x_bottom[c(235:239)] <- NA
y_bottom[c(235:239)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na_interpolation(x_bottom, option = "spline", maxgap = Inf)
imputedValue1_bottom <- fit1_bottom[235:239]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:5) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/5
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_interpolation spline", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputation summary table for na_interpolation(spline)
```{r}
mad2_5missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse2_5missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape2_5missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa2_5missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb2_5missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st2_5missing = rbind(mad2_5missing, rmse2_5missing, mape2_5missing, ioa2_5missing, fb2_5missing)
st2_5missing
```
------------------------------------------------------------------------------------------------

imputeTS package; spline; 10 Missing Value (smooth)

```{r}
cleandata = clean(dataset)
data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(131:140)]
x_smooth[c(131:140)] <- NA
y_smooth[c(131:140)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na_interpolation(x_smooth, option = "spline", maxgap = Inf)
imputedValue1_smooth <- fit1_smooth[131:140]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:10) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/10
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_interpolation spline", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; spline; 10 Missing Value (peak)
```{r}
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(155:164)]
x_peak[c(155:164)] <- NA
y_peak[c(155:164)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na_interpolation(x_peak, option = "spline", maxgap = Inf)
imputedValue1_peak <- fit1_peak[155:164]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:10) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/10
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_interpolation spline", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; linear; 10 Missing Value (spline)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(234:243)]
x_bottom[c(234:243)] <- NA
y_bottom[c(234:243)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na_interpolation(x_bottom, option = "spline", maxgap = Inf)
imputedValue1_bottom <- fit1_bottom[234:243]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:10) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/10
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_interpolation spline", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputation summary table for na_interpolation(spline) with 10 missing values
```{r}
mad2_10missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse2_10missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape2_10missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa2_10missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb2_10misssing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st2_10missing = rbind(mad2_10missing, rmse2_10missing, mape2_10missing, ioa2_10missing, fb2_10misssing)
st2_10missing
```
------------------------------------------------------------------------------------------------------

imputeTS package; spliner; 20 Missing Value (smooth)
```{r}
cleandata = clean(dataset)
data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(125:144)]
x_smooth[c(125:144)] <- NA
y_smooth[c(125:144)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na_interpolation(x_smooth, option = "spline", maxgap = Inf)
imputedValue1_smooth <- fit1_smooth[125:144]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:20) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/20
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_interpolation spline", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; spline; 20 Missing Value (peak)
```{r}
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(150:169)]
x_peak[c(150:169)] <- NA
y_peak[c(150:169)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na_interpolation(x_peak, option = "spline", maxgap = Inf)
imputedValue1_peak <- fit1_peak[150:169]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:20) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/20
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_interpolation spline", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; spline; 20 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(230:249)]
x_bottom[c(230:249)] <- NA
y_bottom[c(230:249)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na_interpolation(x_bottom, option = "spline", maxgap = Inf)
imputedValue1_bottom <- fit1_bottom[230:249]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:20) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/20
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_interpolation spline", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputation summary table for na_interpolation(spline) for 20 missning value
```{r}
mad2_20missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse2_20missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape2_20missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa2_20missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb2_20missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st2_20missing = rbind(mad2_20missing, rmse2_20missing, mape2_20missing, ioa2_20missing, fb2_20missing)
st2_20missing
```

------------------------------------------------------------------------------------------------------
imputeTS package; spline; 30 Missing Value (smooth)
```{r}
cleandata = clean(dataset)
data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(120:149)]
x_smooth[c(120:149)] <- NA
y_smooth[c(120:149)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na_interpolation(x_smooth, option = "spline", maxgap = Inf)
imputedValue1_smooth <- fit1_smooth[120:149]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:30) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/30
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_interpolation spline", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; spline; 30 Missing Value (peak)
```{r}
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(145:174)]
x_peak[c(145:174)] <- NA
y_peak[c(145:174)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na_interpolation(x_peak, option = "spline", maxgap = Inf)
imputedValue1_peak <- fit1_peak[145:174]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:30) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/30
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_interpolation spline", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; spline; 30 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(225:254)]
x_bottom[c(225:254)] <- NA
y_bottom[c(225:254)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na_interpolation(x_bottom, option = "spline", maxgap = Inf)
imputedValue1_bottom <- fit1_bottom[225:254]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:30) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/30
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_interpolation spline", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputation summary table for na_interpolation(spline) for 30 missing values
```{r}
mad2_30missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse2_30missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape2_30missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa2_30missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb2_30missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st2_30missing = rbind(mad2_30missing, rmse2_30missing, mape2_30missing, ioa2_30missing, fb2_30missing)
st2_30missing
```

-------------------------------------------------------------------------------------------
imputeTS package; spline; 35 Missing Value (smooth)
```{r}
# cleandata = clean(dataset)
# data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(118:152)]
x_smooth[c(118:152)] <- NA
y_smooth[c(118:152)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na_interpolation(x_smooth, option = "spline", maxgap = Inf)
imputedValue1_smooth <- fit1_smooth[118:152]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:35) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/35
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_interpolation spline", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; spline; 35 Missing Value (peak)
```{r}
impuGV <- naInsert(data[[4]])
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(150:184)]
x_peak[c(150:184)] <- NA
y_peak[c(150:184)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na_interpolation(x_peak, option = "spline", maxgap = Inf)
imputedValue1_peak <- fit1_peak[150:184]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:35) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/35
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_interpolation spline", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; spline; 35 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(223:257)]
x_bottom[c(223:257)] <- NA
y_bottom[c(223:257)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na_interpolation(x_bottom, option = "spline", maxgap = Inf)
imputedValue1_bottom <- fit1_bottom[223:257]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:35) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/35
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_interpolation spline", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```

imputation summary table for spline for 35 missing values
```{r}
mad2_35missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse2_35missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape2_35missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa2_35missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb2_35missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st2_35missing = rbind(mad2_35missing, rmse2_35missing, mape2_35missing, ioa2_35missing, fb2_35missing)
st2_35missing
```
----------------------------------------------------------------------------------------
imputeTS package; spline; 40 Missing Value (smooth)
```{r}
# cleandata = clean(dataset)
# data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(115:154)]
x_smooth[c(115:154)] <- NA
y_smooth[c(115:154)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na_interpolation(x_smooth, option = "spline", maxgap = Inf)
imputedValue1_smooth <- fit1_smooth[115:154]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:40) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/40
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_interpolation spline", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; spline; 40 Missing Value (peak)
```{r}
impuGV <- naInsert(data[[4]])
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(148:187)]
x_peak[c(148:187)] <- NA
y_peak[c(148:187)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na_interpolation(x_peak, option = "spline", maxgap = Inf)
imputedValue1_peak <- fit1_peak[148:187]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:40) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/40
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_interpolation spline", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; spline; 40 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(220:259)]
x_bottom[c(220:259)] <- NA
y_bottom[c(220:259)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na_interpolation(x_bottom, option = "spline", maxgap = Inf)
imputedValue1_bottom <- fit1_bottom[220:259]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:40) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/40
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_interpolation spline", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```

imputation summary table for spline for 40 missing values
```{r}
mad2_40missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse2_40missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape2_40missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa2_40missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb2_40missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st2_40missing = rbind(mad2_40missing, rmse2_40missing, mape2_40missing, ioa2_40missing, fb2_40missing)
st2_40missing
```
----------------------------------------------------------------------------------------
imputeTS package; spline; 50 Missing Value (smooth)
```{r}
# cleandata = clean(dataset)
# data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(110:159)]
x_smooth[c(110:159)] <- NA
y_smooth[c(110:159)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na_interpolation(x_smooth, option = "spline", maxgap = Inf)
imputedValue1_smooth <- fit1_smooth[110:159]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:50) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/50
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_interpolation spline", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; spline; 50 Missing Value (peak)
```{r}
impuGV <- naInsert(data[[4]])
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(143:192)]
x_peak[c(148:187)] <- NA
y_peak[c(148:187)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na_interpolation(x_peak, option = "spline", maxgap = Inf)
imputedValue1_peak <- fit1_peak[148:187]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:50) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/50
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_interpolation spline", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; spline; 50 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(215:264)]
x_bottom[c(215:264)] <- NA
y_bottom[c(215:264)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na_interpolation(x_bottom, option = "spline", maxgap = Inf)
imputedValue1_bottom <- fit1_bottom[215:264]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:50) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/50
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_interpolation spline", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```

imputation summary table for na_interpolation(spline) for 50 missing values
```{r}
mad2_50missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse2_50missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape2_50missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa2_50missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb2_50missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st2_50missing = rbind(mad2_50missing, rmse2_50missing, mape2_50missing, ioa2_50missing, fb2_50missing)
st2_50missing
```

----------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------

imputeTS package; stine; 5 Missing Value (smooth)
```{r}
cleandata = clean(dataset)
data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(131:135)]
x_smooth[c(131:135)] <- NA
y_smooth[c(131:135)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na_interpolation(x_smooth, option = "stine", maxgap = Inf)
imputedValue1_smooth <- fit1_smooth[131:135]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:5) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/5
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_interpolation stine", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; stine; 5 Missing Value (peak)
```{r}
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(157:161)]
x_peak[c(157:161)] <- NA
y_peak[c(157:161)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na_interpolation(x_peak, option = "stine", maxgap = Inf)
imputedValue1_peak <- fit1_peak[157:161]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:5) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/5
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_interpolation stine", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; stine; 5 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(235:239)]
x_bottom[c(235:239)] <- NA
y_bottom[c(235:239)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na_interpolation(x_bottom, option = "stine", maxgap = Inf)
imputedValue1_bottom <- fit1_bottom[235:239]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:5) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/5
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_interpolation stine", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputation summary table for na_interpolation(stine) for 5 missing values
```{r}
mad3_5missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse3_5missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape3_5missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa3_5missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb3_5missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st3_5missing = rbind(mad3_5missing, rmse3_5missing, mape3_5missing, ioa3_5missing, fb3_5missing)
st3_5missing
```
----------------------------------------------------------------------------------------------

imputeTS package; stine; 10 Missing Value (smooth)

```{r}
cleandata = clean(dataset)
data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(131:140)]
x_smooth[c(131:140)] <- NA
y_smooth[c(131:140)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na_interpolation(x_smooth, option = "stine", maxgap = Inf)
imputedValue1_smooth <- fit1_smooth[131:140]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:10) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/10
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_interpolation stine", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; stine; 10 Missing Value (peak)
```{r}
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(155:164)]
x_peak[c(155:164)] <- NA
y_peak[c(155:164)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na_interpolation(x_peak, option = "stine", maxgap = Inf)
imputedValue1_peak <- fit1_peak[155:164]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:10) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/10
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_interpolation stine", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; stine; 10 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(234:243)]
x_bottom[c(234:243)] <- NA
y_bottom[c(234:243)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na_interpolation(x_bottom, option = "stine", maxgap = Inf)
imputedValue1_bottom <- fit1_bottom[234:243]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:10) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/10
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_interpolation stine", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputation summary table for na_interpolation(stine) for 10 missing values
```{r}
mad3_10missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse3_10missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape3_10missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa3_10missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb3_10missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st3_10missing = rbind(mad3_10missing, rmse3_10missing, mape3_10missing, ioa3_10missing, fb3_10missing)
st3_10missing
```
------------------------------------------------------------------------------------------------------

imputeTS package; stine; 20 Missing Value (smooth)
```{r}
cleandata = clean(dataset)
data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(125:144)]
x_smooth[c(125:144)] <- NA
y_smooth[c(125:144)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na_interpolation(x_smooth, option = "stine", maxgap = Inf)
imputedValue1_smooth <- fit1_smooth[125:144]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:20) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/20
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_interpolation stine", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; stine; 20 Missing Value (peak)
```{r}
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(150:169)]
x_peak[c(150:169)] <- NA
y_peak[c(150:169)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na_interpolation(x_peak, option = "stine", maxgap = Inf)
imputedValue1_peak <- fit1_peak[150:169]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:20) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/20
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_interpolation stine", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; stine; 20 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(230:249)]
x_bottom[c(230:249)] <- NA
y_bottom[c(230:249)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na_interpolation(x_bottom, option = "stine", maxgap = Inf)
imputedValue1_bottom <- fit1_bottom[230:249]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:20) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/20
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_interpolation stine", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputation summary table for na_interpolation(stine) for 20 missing values
```{r}
mad3_20missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse3_20missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape3_20missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa3_20missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb3_20missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st3_20missing = rbind(mad3_20missing, rmse3_20missing, mape3_20missing, ioa3_20missing, fb3_20missing)
st3_20missing
```

----------------------------------------------------------------------------------------------

imputeTS package; stine; 30 Missing Value (smooth)
```{r}
cleandata = clean(dataset)
data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(120:149)]
x_smooth[c(120:149)] <- NA
y_smooth[c(120:149)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na_interpolation(x_smooth, option = "stine", maxgap = Inf)
imputedValue1_smooth <- fit1_smooth[120:149]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:30) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/30
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_interpolation stine", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; stine; 30 Missing Value (peak)
```{r}
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(145:174)]
x_peak[c(145:174)] <- NA
y_peak[c(145:174)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na_interpolation(x_peak, option = "stine", maxgap = Inf)
imputedValue1_peak <- fit1_peak[145:174]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:30) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/30
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_interpolation stine", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; stine; 30 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(225:254)]
x_bottom[c(225:254)] <- NA
y_bottom[c(225:254)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na_interpolation(x_bottom, option = "stine", maxgap = Inf)
imputedValue1_bottom <- fit1_bottom[225:254]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:30) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/30
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_interpolation stine", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputation summary table for na_interpolation(stine) for 30 missing values
```{r}
mad3_30missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse3_30missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape3_30missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa3_30missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb3_30missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st3_30missing = rbind(mad3_30missing, rmse3_30missing, mape3_30missing, ioa3_30missing, fb3_30missing)
st3_30missing
```

-------------------------------------------------------------------------------------------
imputeTS package; stine; 35 Missing Value (smooth)
```{r}
# cleandata = clean(dataset)
# data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(118:152)]
x_smooth[c(118:152)] <- NA
y_smooth[c(118:152)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na_interpolation(x_smooth, option ="stine", maxgap = Inf)
imputedValue1_smooth <- fit1_smooth[118:152]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:35) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/35
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_interpolation stine", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; stine; 35 Missing Value (peak)
```{r}
impuGV <- naInsert(data[[4]])
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(150:184)]
x_peak[c(150:184)] <- NA
y_peak[c(150:184)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na_interpolation(x_peak, option = "stine", maxgap = Inf)
imputedValue1_peak <- fit1_peak[150:184]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:35) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/35
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_interpolation stine", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; stine; 35 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(223:257)]
x_bottom[c(223:257)] <- NA
y_bottom[c(223:257)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na_interpolation(x_bottom, option = "stine", maxgap = Inf)
imputedValue1_bottom <- fit1_bottom[223:257]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:35) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/35
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_interpolation stine", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```

imputation summary table for stine for 35 missing values
```{r}
mad3_35missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse3_35missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape3_35missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa3_35missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb3_35missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st3_35missing = rbind(mad3_35missing, rmse3_35missing, mape3_35missing, ioa3_35missing, fb3_35missing)
st3_35missing
```
----------------------------------------------------------------------------------------
imputeTS package; stine; 40 Missing Value (smooth)
```{r}
# cleandata = clean(dataset)
# data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(115:154)]
x_smooth[c(115:154)] <- NA
y_smooth[c(115:154)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na_interpolation(x_smooth, option = "stine", maxgap = Inf)
imputedValue1_smooth <- fit1_smooth[115:154]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:40) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/40
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_interpolation stine", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; stine; 40 Missing Value (peak)
```{r}
impuGV <- naInsert(data[[4]])
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(148:187)]
x_peak[c(148:187)] <- NA
y_peak[c(148:187)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na_interpolation(x_peak, option = "stine", maxgap = Inf)
imputedValue1_peak <- fit1_peak[148:187]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:40) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/40
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_interpolation stine", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; stine; 40 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(220:259)]
x_bottom[c(220:259)] <- NA
y_bottom[c(220:259)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na_interpolation(x_bottom, option = "stine", maxgap = Inf)
imputedValue1_bottom <- fit1_bottom[220:259]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:40) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/40
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_interpolation stine", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```

imputation summary table for stine for 40 missing values
```{r}
mad3_40missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse3_40missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape3_40missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa3_40missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb3_40missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st3_40missing = rbind(mad3_40missing, rmse3_40missing, mape3_40missing, ioa3_40missing, fb3_40missing)
st3_40missing
```
----------------------------------------------------------------------------------------
imputeTS package; stine; 50 Missing Value (smooth)
```{r}
# cleandata = clean(dataset)
# data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(110:159)]
x_smooth[c(110:159)] <- NA
y_smooth[c(110:159)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na_interpolation(x_smooth, option = "stine", maxgap = Inf)
imputedValue1_smooth <- fit1_smooth[110:159]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:50) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/50
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_interpolation stine", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; stine; 50 Missing Value (peak)
```{r}
impuGV <- naInsert(data[[4]])
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(143:192)]
x_peak[c(148:187)] <- NA
y_peak[c(148:187)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na_interpolation(x_peak, option = "stine", maxgap = Inf)
imputedValue1_peak <- fit1_peak[148:187]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:50) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/50
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_interpolation stine", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; stine; 50 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(215:264)]
x_bottom[c(215:264)] <- NA
y_bottom[c(215:264)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na_interpolation(x_bottom, option = "stine", maxgap = Inf)
imputedValue1_bottom <- fit1_bottom[215:264]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:50) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/50
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_interpolation stine", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```

imputation summary table for stine for 50 missing values
```{r}
mad3_50missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse3_50missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape3_50missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa3_50missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb3_50missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st3_50missing = rbind(mad3_50missing, rmse3_50missing, mape3_50missing, ioa3_50missing, fb3_50missing)
st3_50missing
```


----------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------

imputeTS package; na_kalman; 5 Missing Value (smooth)
```{r}
cleandata = clean(dataset)
data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(131:135)]
x_smooth[c(131:135)] <- NA
y_smooth[c(131:135)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na_kalman(x_smooth, model = "StructTS", smooth = TRUE)
imputedValue1_smooth <- fit1_smooth[131:135]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:5) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/5
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_kalman", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; na_kalman; 5 Missing Value (peak)
```{r}
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(157:161)]
x_peak[c(157:161)] <- NA
y_peak[c(157:161)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na_kalman(x_peak, model = "StructTS", smooth = TRUE)
imputedValue1_peak <- fit1_peak[157:161]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:5) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/5
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_kalman", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; na_kalman; 5 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(235:239)]
x_bottom[c(235:239)] <- NA
y_bottom[c(235:239)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na_kalman(x_bottom, model = "StructTS", smooth = TRUE)
imputedValue1_bottom <- fit1_bottom[235:239]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:5) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/5
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_kalman", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputation summary table for na_kalman for 5 missing values
```{r}
mad4_5missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse4_5missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape4_5missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa4_5missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb4_5missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st4_5missing = rbind(mad4_5missing, rmse4_5missing, mape4_5missing, ioa4_5missing, fb4_5missing)
st4_5missing
```
------------------------------------------------------------------------------------------------

imputeTS package; na_kalman; 10 Missing Value (smooth)

```{r}
cleandata = clean(dataset)
data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(131:140)]
x_smooth[c(131:140)] <- NA
y_smooth[c(131:140)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na_kalman(x_smooth, model = "StructTS", smooth = TRUE)
imputedValue1_smooth <- fit1_smooth[131:140]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:10) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/10
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_kalman", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; na_kalman; 10 Missing Value (peak)
```{r}
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(155:164)]
x_peak[c(155:164)] <- NA
y_peak[c(155:164)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na_kalman(x_peak, model = "StructTS", smooth = TRUE)
imputedValue1_peak <- fit1_peak[155:164]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:10) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/10
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_kalman", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; na_kalman; 10 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(234:243)]
x_bottom[c(234:243)] <- NA
y_bottom[c(234:243)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na_kalman(x_bottom, model = "StructTS", smooth = TRUE)
imputedValue1_bottom <- fit1_bottom[234:243]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:10) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/10
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_kalman", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputation summary table for na_kalman for 10 missing values
```{r}
mad4_10missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse4_10missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape4_10missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa4_10missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb4_10missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st4_10missing = rbind(mad4_10missing, rmse4_10missing, mape4_10missing, ioa4_10missing, fb4_10missing)
st4_10missing
```
------------------------------------------------------------------------------------------------------

imputeTS package; na_kalman; 20 Missing Value (smooth)
```{r}
cleandata = clean(dataset)
data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(125:144)]
x_smooth[c(125:144)] <- NA
y_smooth[c(125:144)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na_kalman(x_smooth, model = "StructTS", smooth = TRUE)
imputedValue1_smooth <- fit1_smooth[125:144]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:20) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/20
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_kalman", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; na_kalman; 20 Missing Value (peak)
```{r}
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(150:169)]
x_peak[c(150:169)] <- NA
y_peak[c(150:169)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na_kalman(x_peak, model = "StructTS", smooth = TRUE)
imputedValue1_peak <- fit1_peak[150:169]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:20) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/20
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_kalman", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; na_kalman; 20 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(230:249)]
x_bottom[c(230:249)] <- NA
y_bottom[c(230:249)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na_kalman(x_bottom, model = "StructTS", smooth = TRUE)
imputedValue1_bottom <- fit1_bottom[230:249]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:20) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/20
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_kalman", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputation summary table for na_kalman for 20 missing values
```{r}
mad4_20missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse4_20missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape4_20missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa4_20missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb4_20missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st4_20missing = rbind(mad4_20missing, rmse4_20missing, mape4_20missing, ioa4_20missing, fb4_20missing)
st4_20missing
```

----------------------------------------------------------------------------------------------

imputeTS package; na_kalman; 30 Missing Value (smooth)
```{r}
cleandata = clean(dataset)
data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(120:149)]
x_smooth[c(120:149)] <- NA
y_smooth[c(120:149)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na_kalman(x_smooth, model = "StructTS", smooth = TRUE)
imputedValue1_smooth <- fit1_smooth[120:149]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:30) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/30
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_kalman", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; na_kalman; 30 Missing Value (peak)
```{r}
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(145:174)]
x_peak[c(145:174)] <- NA
y_peak[c(145:174)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na_kalman(x_smooth, model = "StructTS", smooth = TRUE)
imputedValue1_peak <- fit1_peak[145:174]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:30) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/30
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_kalman", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; na_kalman; 30 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(225:254)]
x_bottom[c(225:254)] <- NA
y_bottom[c(225:254)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na_kalman(x_bottom, model = "StructTS", smooth = TRUE)
imputedValue1_bottom <- fit1_bottom[225:254]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:30) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/30
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_kalman", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputation summary table for na_kalman for 30 missing values
```{r}
mad4_30missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse4_30missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape4_30missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa4_30missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb4_30missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st4_30missing = rbind(mad4_30missing, rmse4_30missing, mape4_30missing, ioa4_30missing, fb4_30missing)
st4_30missing
```
-------------------------------------------------------------------------------------------

imputeTS package; na_kalman; 35 Missing Value (smooth)
```{r}
# cleandata = clean(dataset)
# data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(118:152)]
x_smooth[c(118:152)] <- NA
y_smooth[c(118:152)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na_kalman(x_smooth, model = "StructTS", smooth = TRUE)
imputedValue1_smooth <- fit1_smooth[118:152]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:35) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/35
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_kalman", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; na_kalman; 35 Missing Value (peak)
```{r}
impuGV <- naInsert(data[[4]])
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(150:184)]
x_peak[c(150:184)] <- NA
y_peak[c(150:184)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na_kalman(x_peak, model = "StructTS", smooth = TRUE)
imputedValue1_peak <- fit1_peak[150:184]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:35) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/35
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_kalman", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; na_kalman; 35 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(223:257)]
x_bottom[c(223:257)] <- NA
y_bottom[c(223:257)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na_kalman(x_bottom, model = "StructTS", smooth = TRUE)
imputedValue1_bottom <- fit1_bottom[223:257]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:35) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/35
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_kalman", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```

imputation summary table for na_kalman for 35 missing values
```{r}
mad4_35missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse4_35missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape4_35missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa4_35missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb4_35missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st4_35missing = rbind(mad4_35missing, rmse4_35missing, mape4_35missing, ioa4_35missing, fb4_35missing)
st4_35missing
```
----------------------------------------------------------------------------------------
imputeTS package; na_kalman; 40 Missing Value (smooth)
```{r}
# cleandata = clean(dataset)
# data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(115:154)]
x_smooth[c(115:154)] <- NA
y_smooth[c(115:154)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na_kalman(x_smooth, model = "StructTS", smooth = TRUE)
imputedValue1_smooth <- fit1_smooth[115:154]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:40) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/40
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_kalman", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; na_kalman; 35 Missing Value (peak)
```{r}
impuGV <- naInsert(data[[4]])
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(148:187)]
x_peak[c(148:187)] <- NA
y_peak[c(148:187)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na_kalman(x_peak, model = "StructTS", smooth = TRUE)
imputedValue1_peak <- fit1_peak[148:187]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:40) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/40
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_kalman", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; na_kalman; 40 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(220:259)]
x_bottom[c(220:259)] <- NA
y_bottom[c(220:259)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na_kalman(x_bottom, model = "StructTS", smooth = TRUE)
imputedValue1_bottom <- fit1_bottom[220:259]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:40) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/40
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_kalman", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```

imputation summary table for na_kalman for 40 missing values
```{r}
mad4_40missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse4_40missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape4_40missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa4_40missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb4_40missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st4_40missing = rbind(mad4_40missing, rmse4_40missing, mape4_40missing, ioa4_40missing, fb4_40missing)
st4_40missing
```
----------------------------------------------------------------------------------------
imputeTS package; na_kalman; 50 Missing Value (smooth)
```{r}
# cleandata = clean(dataset)
# data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(110:159)]
x_smooth[c(110:159)] <- NA
y_smooth[c(110:159)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na_kalman(x_smooth, model = "StructTS", smooth = TRUE)
imputedValue1_smooth <- fit1_smooth[110:159]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:50) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/50
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_kalman", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; na_kalman; 50 Missing Value (peak)
```{r}
impuGV <- naInsert(data[[4]])
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(143:192)]
x_peak[c(148:187)] <- NA
y_peak[c(148:187)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na_kalman(x_peak, model = "StructTS", smooth = TRUE)
imputedValue1_peak <- fit1_peak[148:187]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:50) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/50
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_kalman", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; na_kalman; 50 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(215:264)]
x_bottom[c(215:264)] <- NA
y_bottom[c(215:264)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na_kalman(x_bottom, model = "StructTS", smooth = TRUE)
imputedValue1_bottom <- fit1_bottom[215:264]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:50) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/50
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_kalman", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```

imputation summary table for na_kalman for 50 missing values
```{r}
mad4_50missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse4_50missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape4_50missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa4_50missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb4_50missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st4_50missing = rbind(mad4_50missing, rmse4_50missing, mape4_50missing, ioa4_50missing, fb4_50missing)
st4_50missing
```

----------------------------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------------------------

imputeTS package; na_locf; 5 Missing Value (smooth)
```{r}
cleandata = clean(dataset)
data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(131:135)]
x_smooth[c(131:135)] <- NA
y_smooth[c(131:135)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na_locf(x_smooth, option = "locf", na_remaining = "rev", maxgap = Inf)
imputedValue1_smooth <- fit1_smooth[131:135]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:5) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/5
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_locf", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; na_locf; 5 Missing Value (peak)
```{r}
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(157:161)]
x_peak[c(157:161)] <- NA
y_peak[c(157:161)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na_locf(x_peak, option = "locf", na_remaining = "rev", maxgap = Inf)
imputedValue1_peak <- fit1_peak[157:161]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:5) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/5
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_locf", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; na_locf; 5 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(235:239)]
x_bottom[c(235:239)] <- NA
y_bottom[c(235:239)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na_locf(x_bottom, option = "locf", na_remaining = "rev", maxgap = Inf)
imputedValue1_bottom <- fit1_bottom[235:239]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:5) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/5
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_locf", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputation summary table for na_locf for 5 missing values
```{r}
mad5_5missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse5_5missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape5_5missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa5_5missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb5_5missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st5_5missing = rbind(mad5_5missing, rmse5_5missing, mape5_5missing, ioa5_5missing, fb5_5missing)
st5_5missing
```
------------------------------------------------------------------------------------------------

imputeTS package; na_locf; 10 Missing Value (smooth)

```{r}
cleandata = clean(dataset)
data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(131:140)]
x_smooth[c(131:140)] <- NA
y_smooth[c(131:140)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na_locf(x_smooth, option = "locf", na_remaining = "rev", maxgap = Inf)
imputedValue1_smooth <- fit1_smooth[131:140]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:10) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/10
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_locf", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; na_locf; 10 Missing Value (peak)
```{r}
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(155:164)]
x_peak[c(155:164)] <- NA
y_peak[c(155:164)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na_locf(x_peak, option = "locf", na_remaining = "rev", maxgap = Inf)
imputedValue1_peak <- fit1_peak[155:164]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:10) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/10
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_locf", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; na_locf; 10 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(234:243)]
x_bottom[c(234:243)] <- NA
y_bottom[c(234:243)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na_locf(x_bottom, option = "locf", na_remaining = "rev", maxgap = Inf)
imputedValue1_bottom <- fit1_bottom[234:243]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:10) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/10
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_locf", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputation summary table for na_locf for 10 missing values
```{r}
mad5_10missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse5_10missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape5_10missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa5_10missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb5_10missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st5_10missing = rbind(mad5_10missing, rmse5_10missing, mape5_10missing, ioa5_10missing, fb5_10missing)
st5_10missing
```
----------------------------------------------------------------------------------------------

imputeTS package; na_locf; 20 Missing Value (smooth)
```{r}
cleandata = clean(dataset)
data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(125:144)]
x_smooth[c(125:144)] <- NA
y_smooth[c(125:144)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na_locf(x_smooth, option = "locf", na_remaining = "rev", maxgap = Inf)
imputedValue1_smooth <- fit1_smooth[125:144]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:20) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/20
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_locf", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; na_locf; 20 Missing Value (peak)
```{r}
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(150:169)]
x_peak[c(150:169)] <- NA
y_peak[c(150:169)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na_locf(x_peak, option = "locf", na_remaining = "rev", maxgap = Inf)
imputedValue1_peak <- fit1_peak[150:169]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:20) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/20
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_locf", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; na_locf; 20 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(230:249)]
x_bottom[c(230:249)] <- NA
y_bottom[c(230:249)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na_locf(x_bottom, option = "locf", na_remaining = "rev", maxgap = Inf)
imputedValue1_bottom <- fit1_bottom[230:249]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:20) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/20
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_locf", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputation summary table for na_locf for 20 missing values
```{r}
mad5_20missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse5_20missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape5_20missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa5_20missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb5_20missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st5_20missing = rbind(mad5_20missing, rmse5_20missing, mape5_20missing, ioa5_20missing, fb5_20missing)
st5_20missing
```

----------------------------------------------------------------------------------------------

imputeTS package; na_locf; 30 Missing Value (smooth)
```{r}
cleandata = clean(dataset)
data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(120:149)]
x_smooth[c(120:149)] <- NA
y_smooth[c(120:149)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na_locf(x_smooth, option = "locf", na_remaining = "rev", maxgap = Inf)
imputedValue1_smooth <- fit1_smooth[120:149]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:30) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/30
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_locf", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; na_locf; 30 Missing Value (peak)
```{r}
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(145:174)]
x_peak[c(145:174)] <- NA
y_peak[c(145:174)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na_locf(x_peak, option = "locf", na_remaining = "rev", maxgap = Inf)
imputedValue1_peak <- fit1_peak[145:174]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:30) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/30
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_locf", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; na_locf; 30 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(225:254)]
x_bottom[c(225:254)] <- NA
y_bottom[c(225:254)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na_locf(x_bottom, option = "locf", na_remaining = "rev", maxgap = Inf)
imputedValue1_bottom <- fit1_bottom[225:254]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:30) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/30
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_locf", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputation summary table for na_locf for 30 missing values
```{r}
mad5_30missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse5_30missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape5_30missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa5_30missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb5_30missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st5_30missing = rbind(mad5_30missing, rmse5_30missing, mape5_30missing, ioa5_30missing, fb5_30missing)
st5_30missing
```
-------------------------------------------------------------------------------------------

imputeTS package; na_locf; 35 Missing Value (smooth)
```{r}
# cleandata = clean(dataset)
# data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(118:152)]
x_smooth[c(118:152)] <- NA
y_smooth[c(118:152)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na_locf(x_smooth, option = "locf", na_remaining = "rev", maxgap = Inf)
imputedValue1_smooth <- fit1_smooth[118:152]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:35) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/35
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_locf", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; na_locf; 35 Missing Value (peak)
```{r}
impuGV <- naInsert(data[[4]])
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(150:184)]
x_peak[c(150:184)] <- NA
y_peak[c(150:184)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na_locf(x_peak, option = "locf", na_remaining = "rev", maxgap = Inf)
imputedValue1_peak <- fit1_peak[150:184]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:35) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/35
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_locf", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; na_locf; 35 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(223:257)]
x_bottom[c(223:257)] <- NA
y_bottom[c(223:257)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na_locf(x_bottom, option = "locf", na_remaining = "rev", maxgap = Inf)
imputedValue1_bottom <- fit1_bottom[223:257]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:35) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/35
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_locf", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```

imputation summary table for na_locf for 35 missing values
```{r}
mad5_35missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse5_35missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape5_35missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa5_35missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb5_35missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st5_35missing = rbind(mad5_35missing, rmse5_35missing, mape5_35missing, ioa5_35missing, fb5_35missing)
st5_35missing
```
----------------------------------------------------------------------------------------
imputeTS package; na_locf; 40 Missing Value (smooth)
```{r}
# cleandata = clean(dataset)
# data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(115:154)]
x_smooth[c(115:154)] <- NA
y_smooth[c(115:154)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na_locf(x_smooth, option = "locf", na_remaining = "rev", maxgap = Inf)
imputedValue1_smooth <- fit1_smooth[115:154]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:40) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/40
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_locf", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; na_locf; 40 Missing Value (peak)
```{r}
impuGV <- naInsert(data[[4]])
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(148:187)]
x_peak[c(148:187)] <- NA
y_peak[c(148:187)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na_locf(x_peak, option = "locf", na_remaining = "rev", maxgap = Inf)
imputedValue1_peak <- fit1_peak[148:187]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:40) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/40
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_locf", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; na_locf; 40 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(220:259)]
x_bottom[c(220:259)] <- NA
y_bottom[c(220:259)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na_locf(x_bottom, option = "locf", na_remaining = "rev", maxgap = Inf)
imputedValue1_bottom <- fit1_bottom[220:259]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:40) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/40
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_locf", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```

imputation summary table for na_locf for 40 missing values
```{r}
mad5_40missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse5_40missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape5_40missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa5_40missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb5_40missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st5_40missing = rbind(mad5_40missing, rmse5_40missing, mape5_40missing, ioa5_40missing, fb5_40missing)
st5_40missing
```
----------------------------------------------------------------------------------------
imputeTS package; na_locf; 50 Missing Value (smooth)
```{r}
# cleandata = clean(dataset)
# data = aList(cleandata)
impuGV <- naInsert(data[[4]])
t <- impuGV[,1]
x0_smooth <- x_smooth <- y_smooth <- zoo(impuGV[,3], t)[c(422:709)]
t1_smooth = index(x0_smooth)

trueValue_smooth <- x_smooth[c(110:159)]
x_smooth[c(110:159)] <- NA
y_smooth[c(110:159)] <- NA
id.na <- which(is.na(x_smooth))

fit1_smooth <- na_locf(x_smooth, option = "locf", na_remaining = "rev", maxgap = Inf)
imputedValue1_smooth <- fit1_smooth[110:159]
tv1_smooth <- vector()
iv1_smooth <- vector()
sum1_smooth = 0
for (i in 1:50) {
  tv1_smooth[i] = as.numeric(trueValue_smooth[i])
  iv1_smooth[i] = as.numeric(imputedValue1_smooth[i])
  sum1_smooth = sum1_smooth + abs(iv1_smooth[i]-tv1_smooth[i])
}
mad1_smooth = sum1_smooth/50
rmse1_smooth = rmse(tv1_smooth,iv1_smooth)
mape1_smooth = MAPE(iv1_smooth,tv1_smooth)*100
ioa1_smooth = d(iv1_smooth,tv1_smooth)
fb1_smooth = compute.fb(iv1_smooth,tv1_smooth,verbose = F)
a = rbind(mad1_smooth, rmse1_smooth, mape1_smooth, ioa1_smooth, fb1_smooth)
a

#plot
plot(x0_smooth, col = "grey", main = "na_locf", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_smooth)
points(t1_smooth[id.na], x0_smooth[id.na], col = "blue", pch = 19)
points(t1_smooth[id.na], fit1_smooth[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; na_locf; 50 Missing Value (peak)
```{r}
impuGV <- naInsert(data[[4]])
x0_peak <- x_peak <- y_peak <- zoo(impuGV[,3], t)[c(422:709)]
t1_peak = index(x0_peak)

trueValue_peak <- x_peak[c(143:192)]
x_peak[c(148:187)] <- NA
y_peak[c(148:187)] <- NA
id.na <- which(is.na(x_peak))

fit1_peak <- na_locf(x_peak, option = "locf", na_remaining = "rev", maxgap = Inf)
imputedValue1_peak <- fit1_peak[148:187]
tv1_peak <- vector()
iv1_peak <- vector()
sum1_peak = 0
for (i in 1:50) {
  tv1_peak[i] = as.numeric(trueValue_peak[i])
  iv1_peak[i] = as.numeric(imputedValue1_peak[i])
  sum1_peak = sum1_peak + abs(iv1_peak[i]-tv1_peak[i])
}
mad1_peak = sum1_peak/50
rmse1_peak = rmse(tv1_peak,iv1_peak)
mape1_peak = MAPE(iv1_peak,tv1_peak)*100
ioa1_peak = d(iv1_peak,tv1_peak)
fb1_peak = compute.fb(iv1_peak,tv1_peak,verbose = F)
b = rbind(mad1_peak, rmse1_peak, mape1_peak, ioa1_peak, fb1_peak)
b

#plot
plot(x0_peak, col = "grey", main = "na_locf", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_peak)
points(t1_peak[id.na], x0_peak[id.na], col = "blue", pch = 19)
points(t1_peak[id.na], fit1_peak[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```
imputeTS package; na_locf; 50 Missing Value (bottom)
```{r}
x0_bottom <- x_bottom <- y_bottom <- zoo(impuGV[,3], t)[c(422:709)]
t1_bottom = index(x0_bottom)

trueValue_bottom <- x_bottom[c(215:264)]
x_bottom[c(215:264)] <- NA
y_bottom[c(215:264)] <- NA
id.na <- which(is.na(x_bottom))

fit1_bottom <- na_locf(x_bottom, option = "locf", na_remaining = "rev", maxgap = Inf)
imputedValue1_bottom <- fit1_bottom[215:264]
tv1_bottom <- vector()
iv1_bottom <- vector()
sum1_bottom = 0
for (i in 1:50) {
  tv1_bottom[i] = as.numeric(trueValue_bottom[i])
  iv1_bottom[i] = as.numeric(imputedValue1_bottom[i])
  sum1_bottom = sum1_bottom + abs(iv1_bottom[i]-tv1_bottom[i])
}
mad1_bottom = sum1_bottom/50
rmse1_bottom = rmse(tv1_bottom,iv1_bottom)
mape1_bottom = MAPE(iv1_bottom,tv1_bottom)*100
ioa1_bottom = d(iv1_bottom,tv1_bottom)
fb1_bottom = compute.fb(iv1_bottom,tv1_bottom,verbose = F)
c = rbind(mad1_bottom, rmse1_bottom, mape1_bottom, ioa1_bottom, fb1_bottom)
c

#plot
plot(x0_bottom, col = "grey", main = "na_locf", xlab = "DisplayTime", ylab = "GlucoseValue")
lines(x_bottom)
points(t1_bottom[id.na], x0_bottom[id.na], col = "blue", pch = 19)
points(t1_bottom[id.na], fit1_bottom[id.na], col = "red", pch = 17)
legend("topright", legend = c("true values", "imputed values"), col = c("blue", "red"), pch = c(19,17))
```

imputation summary table for na_locf for 50 missing values
```{r}
mad5_50missing = (mad1_smooth + mad1_peak + mad1_bottom) / 3
rmse5_50missing = (rmse1_smooth + rmse1_peak + rmse1_bottom) / 3 
mape5_50missing = (mape1_smooth + mape1_peak + rmse1_bottom) / 3
ioa5_50missing = (ioa1_smooth + ioa1_bottom + ioa1_peak) / 3
fb5_50missing = (fb1_smooth + fb1_bottom + fb1_bottom) / 3
st5_50missing = rbind(mad5_50missing, rmse5_50missing, mape5_50missing, ioa5_50missing, fb5_50missing)
st5_50missing
```

-------------------------------------------------------------------------------------
imputation summary table for imputeTS package
```{r}
impuSumTable_st1 = data.frame(st1_5missing,st1_10missing,st1_20missing,st1_30missing,st1_35missing,st1_40missing,st1_50missing)
row.names(impuSumTable_st1) <- c("MAD_imputeTS_linear","RMSE_imputeTS_linear","MAPE_imputeTS_linear","IOA_imputeTS_linear","FB_imputeTS_linear")
colnames(impuSumTable_st1) <- c("5missing","10missing","20missing","30missing","35missing","40missing","50missing")

impuSumTable_st2 = data.frame(st2_5missing,st2_10missing,st2_20missing,st2_30missing,st2_35missing,st2_40missing,st2_50missing)
row.names(impuSumTable_st2) <- c("MAD_imputeTS_spline","RMSE_imputeTS_spline","MAPE_imputeTS_spline","IOA_imputeTS_spline","FB_imputeTS_spline")
colnames(impuSumTable_st2) <- c("5missing","10missing","20missing","30missing","35missing","40missing","50missing")

impuSumTable_st3 = data.frame(st3_5missing,st3_10missing,st3_20missing,st3_30missing,st3_35missing,st3_40missing,st3_50missing)
row.names(impuSumTable_st3) <- c("MAD_imputeTS_stine","RMSE_imputeTS_stine","MAPE_imputeTS_stine","IOA_imputeTS_stine","FB_imputeTS_stine")
colnames(impuSumTable_st3) <- c("5missing","10missing","20missing","30missing","35missing","40missing","50missing")

impuSumTable_st4 = data.frame(st4_5missing,st4_10missing,st4_20missing,st4_30missing,st4_35missing,st4_40missing,st4_50missing)
row.names(impuSumTable_st4) <- c("MAD_imputeTS_kalman","RMSE_imputeTS_kalman","MAPE_imputeTS_kalman","IOA_imputeTS_kalman","FB_imputeTS_kalman")
colnames(impuSumTable_st4) <- c("5missing","10missing","20missing","30missing","35missing","40missing","50missing")

impuSumTable_st5 = data.frame(st5_5missing,st5_10missing,st5_20missing,st5_30missing,st5_35missing,st5_40missing,st5_50missing)
row.names(impuSumTable_st5) <- c("MAD_imputeTS_locf","RMSE_imputeTS_locf","MAPE_imputeTS_locf","IOA_imputeTS_locf","FB_imputeTS_locf")
colnames(impuSumTable_st5) <- c("5missing","10missing","20missing","30missing","35missing","40missing","50missing")

impuSumTable_st6 = data.frame(st6_5missing,st6_10missing,st6_20missing,st6_30missing,st6_35missing,st6_40missing,st6_50missing)
row.names(impuSumTable_st6) <- c("MAD_zoo_naapprox","RMSE_zoo_naapprox","MAPE__zoo_naapprox","IOA_zoo_naapprox","FB_zoo_naapprox")
colnames(impuSumTable_st6) <- c("5missing","10missing","20missing","30missing","35missing","40missing","50missing")

impuSumTable_st7 = data.frame(st7_5missing,st7_10missing,st7_20missing,st7_30missing,st7_35missing,st7_40missing,st7_50missing)
row.names(impuSumTable_st7) <- c("MAD_zoo_naspline","RMSE_zoo_naspline","MAPE__zoo_naspline","IOA_zoo_naspline","FB_zoo_naspline")
colnames(impuSumTable_st7) <- c("5missing","10missing","20missing","30missing","35missing","40missing","50missing")

impuSumTable = rbind(impuSumTable_st1,impuSumTable_st2,impuSumTable_st3,impuSumTable_st4,impuSumTable_st5,impuSumTable_st6,impuSumTable_st7)

MAD = rbind(impuSumTable[1,],impuSumTable[6,],impuSumTable[11,],impuSumTable[16,],impuSumTable[21,],impuSumTable[26,],impuSumTable[31,])
row.names(MAD) <- c("imputeTS_linear","imputeTS_spline","imputeTS_stine","imputeTS_kalman","imputeTS_locf","zoo_naapprox","zoo_naspline")
colnames(MAD) <- c("MAD5","MAD10","MAD20","MAD30")

RMSE = rbind(impuSumTable[2,],impuSumTable[7,],impuSumTable[12,],impuSumTable[17,],impuSumTable[22,],impuSumTable[27,],impuSumTable[32,])
row.names(RMSE) <- c("imputeTS_linear","imputeTS_spline","imputeTS_stine","imputeTS_kalman","imputeTS_locf","zoo_naapprox","zoo_naspline")
colnames(RMSE) <- c("RMSE5","RMSE10","RMSE20","RMSE30")

MAPE = rbind(impuSumTable[3,],impuSumTable[8,],impuSumTable[13,],impuSumTable[18,],impuSumTable[23,],impuSumTable[28,],impuSumTable[33,])
row.names(MAPE) <- c("imputeTS_linear","imputeTS_spline","imputeTS_stine","imputeTS_kalman","imputeTS_locf","zoo_naapprox","zoo_naspline")
colnames(MAPE) <- c("MAPE5","MAPE10","MAPE20","MAPE30")


IOA = rbind(impuSumTable[4,],impuSumTable[9,],impuSumTable[14,],impuSumTable[19,],impuSumTable[24,],impuSumTable[29,],impuSumTable[34,])
row.names(IOA) <- c("imputeTS_linear","imputeTS_spline","imputeTS_stine","imputeTS_kalman","imputeTS_locf","zoo_naapprox","zoo_naspline")
colnames(IOA) <- c("IOA5","IOA10","IOA20","IOA30")

FB = rbind(impuSumTable[5,],impuSumTable[10,],impuSumTable[15,],impuSumTable[20,],impuSumTable[25,],impuSumTable[30,],impuSumTable[35,])
row.names(FB) <- c("imputeTS_linear","imputeTS_spline","imputeTS_stine","imputeTS_kalman","imputeTS_locf","zoo_naapprox","zoo_naspline")
colnames(FB) <- c("FB5","FB10","FB20","FB30")

#write.csv(summaryTable, "~/Desktop/imputationSummaryTable.csv")
```


